From 530c5623a6f6c3d995dc388bd6fdc4de83c07c84 Mon Sep 17 00:00:00 2001
Message-Id: <530c5623a6f6c3d995dc388bd6fdc4de83c07c84.1376408877.git.minovotn@redhat.com>
In-Reply-To: <823d94e906b2aeecd2c60bc9f19ca8948a756f27.1376408877.git.minovotn@redhat.com>
References: <823d94e906b2aeecd2c60bc9f19ca8948a756f27.1376408877.git.minovotn@redhat.com>
From: Gerd Hoffmann <kraxel@redhat.com>
Date: Tue, 30 Jul 2013 11:35:29 +0200
Subject: [PATCH 11/18] qemu-char: report udp backend errors

RH-Author: Gerd Hoffmann <kraxel@redhat.com>
Message-id: <1375184130-11076-12-git-send-email-kraxel@redhat.com>
Patchwork-id: 52791
O-Subject: [RHEL-6.5 qemu-kvm PATCH 11/12] qemu-char: report udp backend errors
Bugzilla: 676568
RH-Acked-by: Laszlo Ersek <lersek@redhat.com>
RH-Acked-by: Luiz Capitulino <lcapitulino@redhat.com>
RH-Acked-by: Michael S. Tsirkin <mst@redhat.com>

Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
Reviewed-by: Laszlo Ersek <lersek@redhat.com>
Signed-off-by: Michael Tokarev <mjt@tls.msk.ru>
(cherry picked from commit 58a3714c529b1b97ee078ea25b58f731aabcbfff)
---
 qemu-char.c |    2 ++
 1 file changed, 2 insertions(+)

Signed-off-by: Michal Novotny <minovotn@redhat.com>
---
 qemu-char.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/qemu-char.c b/qemu-char.c
index ea768af..5926615 100644
--- a/qemu-char.c
+++ b/qemu-char.c
@@ -2105,6 +2105,8 @@ static CharDriverState *qemu_chr_open_udp(QemuOpts *opts)
 
     fd = inet_dgram_opts(opts, &local_err);
     if (fd < 0) {
+        qerror_report_err(local_err);
+        error_free(local_err);
         return NULL;
     }
     return qemu_chr_open_udp_fd(fd);
-- 
1.7.11.7

